const c={formatPhone:t=>{let e=t.replace(/\D/g,"");return e.length<10?"":(e.length<=11&&!e.startsWith("55")&&(e="55"+e),e)},sendText:async({instanceUrl:t,token:e,phone:n,message:s})=>{if(!t||!e||!n)return!1;try{const r=c.formatPhone(n);if(!r)return!1;const o=t.replace(/\/$/,""),a=await fetch(`${o}/message/sendText/${r}`,{method:"POST",headers:{"Content-Type":"application/json",apikey:e},body:JSON.stringify({text:s,options:{delay:1200,presence:"composing",linkPreview:!0}})});return a.ok?!0:(console.error("Evolution API Error:",await a.text()),!1)}catch(r){return console.error("Evolution API Exception:",r),!1}},checkConnection:async(t,e)=>{var n;if(!t||!e)return!1;try{const s=t.replace(/\/$/,""),r=await fetch(`${s}/instance/connect`,{method:"GET",headers:{apikey:e}});if(r.ok){const o=await r.json();return((n=o==null?void 0:o.instance)==null?void 0:n.state)==="open"}return!1}catch{return!1}}};export{c as EvolutionApi};
