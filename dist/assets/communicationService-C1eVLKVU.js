import{EvolutionApi as p}from"./evolutionApi-BtEDgQmG.js";const l=2e3;function f(t,n){return t.replace(/\{(\w+)\}/g,(s,c)=>n[c]??`{${c}}`)}async function A(t,n,s,c,i){const o=(i.whatsappClientTemplates||[]).find(m=>m.stepId===t),a={sentAt:new Date().toISOString(),audience:"client",stepId:t,recipientName:s,phone:n,success:!1};if(!o||!o.enabled)return{success:!1,log:a};const e=i.evolutionApi;if(!(e!=null&&e.instanceUrl)||!(e!=null&&e.token)||!(e!=null&&e.instanceName))return{success:!1,log:a};const u=f(o.message,c),r=await p.sendText({instanceUrl:e.instanceUrl,instanceName:e.instanceName,token:e.token,phone:n,message:u});return a.success=!!r,{success:!!r,log:a}}function N(t,n){const s=[n,...t];return s.length>l?s.slice(0,l):s}export{N as addWhatsAppLog,f as resolveTemplate,A as sendClientNotification};
