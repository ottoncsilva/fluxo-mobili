import{EvolutionApi as f}from"./evolutionApi-CwNTxcOI.js";const l=2e3;function m(t,n){return t.replace(/\{(\w+)\}/g,(s,c)=>n[c]??`{${c}}`)}async function A(t,n,s,c,i){const a=(i.whatsappClientTemplates||[]).find(p=>p.stepId===t),o={sentAt:new Date().toISOString(),audience:"client",stepId:t,recipientName:s,phone:n,success:!1};if(!a||!a.enabled)return{success:!1,log:o};const e=i.evolutionApi;if(!(e!=null&&e.instanceUrl)||!(e!=null&&e.token))return{success:!1,log:o};const u=m(a.message,c),r=await f.sendText({instanceUrl:e.instanceUrl,token:e.token,phone:n,message:u});return o.success=!!r,{success:!!r,log:o}}function h(t,n){const s=[n,...t];return s.length>l?s.slice(0,l):s}export{h as addWhatsAppLog,m as resolveTemplate,A as sendClientNotification};
