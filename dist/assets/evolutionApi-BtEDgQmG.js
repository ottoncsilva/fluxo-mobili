const i={formatPhone:t=>{let e=t.replace(/\D/g,"");return e.length<10?"":(e.length<=11&&!e.startsWith("55")&&(e="55"+e),e)},sendText:async({instanceUrl:t,instanceName:e,token:n,phone:o,message:a})=>{if(!t||!e||!n||!o)return!1;try{const r=i.formatPhone(o);if(!r)return!1;const s=t.replace(/\/$/,""),c=await fetch(`${s}/message/sendText/${e}`,{method:"POST",headers:{"Content-Type":"application/json",apikey:n},body:JSON.stringify({number:r,text:a,options:{delay:1200,presence:"composing",linkPreview:!0}})});return c.ok?!0:(console.error("Evolution API Error:",await c.text()),!1)}catch(r){return console.error("Evolution API Exception:",r),!1}},checkConnection:async(t,e,n)=>{var o;if(!t||!e||!n)return!1;try{const a=t.replace(/\/$/,""),r=await fetch(`${a}/instance/connectionState/${e}`,{method:"GET",headers:{apikey:n}});if(r.ok){const s=await r.json();return((o=s==null?void 0:s.instance)==null?void 0:o.state)==="open"}return!1}catch{return!1}}};export{i as EvolutionApi};
